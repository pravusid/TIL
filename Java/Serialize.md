# 직렬화

## 용도

자바 내부의 객체나 데이터 구조를 외부에서 사용할 수 있는 포맷 혹은 네트워크를 통해 전송할 수 있게 byte 형태로 변환하는 것.

객체는 내부에서 레퍼런스 변수로 사용하는데 이 주소값에 관련된 데이터를 모두 끌어와서 Primitive 데이터로 전부 변환 해서 전송/저장 가능한 데이터를 만드는 행위가 '직렬화(Serialization)'

프로세스 간 데이터 전송에도 직렬화가 사용된다. 대부분의 OS 가 가상메모리를 운영 중이며 대부분의 OS 의 프로세스는 서로 다른 가상메모리주소공간을 갖기 때문에 역시 마찬가지로 오브젝트 타입의 참조값으로는 데이터 인스턴스를 직접 줄 수 없어서 직렬화를 하게된다.

## 직렬화 프로세스

- 자바의 primitive type과 java.io.Serializable 인터페이스를 상속받은 객체는 직렬화 할 수있는 조건을 갖춘 것이다.
- 조건을 갖춘 object를 java.io.ObjectOutputStream을 이용해 직렬화 한다.

## 역직렬화 프로세스

- 직렬화 대상이 된 객체의 클래스가 classpath에 존재하고 import 되어 있어야한다.
- 직렬화 대상객체는 동일한 serialVersionUID를 갖고 있어야 한다.

## 참고사항

serialVersionUID 는 Type Safety를 위해 사용한다. 직렬화한 객체를 전송을 했을경우 전송된 객체의 클래스와 원본이 동일한지 확인하는데 사용한다. serialVersionUID 다를경우 java.io.InvalidClassException 이 발생한다.

자바에서는 Serializable 인터페이스를 통해 객체를 직렬화해서(직렬화 한 것을 알려서) 이용할 수 있다.

## 직렬화 데이터 형식

- binary
- JSON
- XML
- YAML

## 직렬화 사용 이유

JVM 메모리에만 존재하던 객체를 영속화(Persistence) 할 때 사용한다. 필요할 때는 데이터를 가지와 역직렬화 해서 사용할 수 있다.

- Servlet Session : WAS에서 세션의 자바직렬화를 지원함. 파일저장, 세션 클러스터링, DB저장시에 세션을 직렬화해서 저장한다.
- Cache : 캐시 라이브러리 (Redis, Memcached ...) 시스템에서 직렬화를 사용함.

## 직렬화 시 유의점

- serialVersionUID 는 직접 관리해야 한다.
- 타입을 정확히 사용해야 한다.(타입에 매우 엄격함)
- 장기간 저장될 데이터는 직렬화를 피해야 한다. (다시 가져왔을 때 기존 클래스가 변했다면 사용할 수 없는 데이터가 된다)
